---
title: "genderwagegap"
author: "Yacine, Victoria and Raphaële"
date: "11/23/2021"
output: 
 github_document: default
---

```{r}
setwd("/Users/hugomarty/Documents/GitHub/Project-of-Econometrics/EE_2018")
library(haven)
d <- read_dta("~/Documents/GitHub/Project-of-Econometrics/EE_2018/Bases/EEC_2018INDIV.dta")

library(questionr)
library(tidyverse)
library(hrbrthemes)
library(foreign)
library(dplyr)
library(stargazer)

# Réduire la base de données -----

sum(d$tppred == 1)
d <- subset(d,tppred==1, drop=TRUE)

library(tidyverse)
dr <- d %>% select(ident,
                  salmee, #salaire continu
                  salmet, #salaire discontinu
                  sexe, #sexe
                  ag, #âge en variable continue
                  nbenfa18, #nombre d'nefants de moins 18
                  dip5, # éducation en 13 postes
                  cser, #CPS
                  nafg004n, # primaire / secondaire / tertiaire
                  chpub, # public / privé
                  ancentr, # ancienneté 
                  immi, # être immigré
                  desc,#être descendant
                  zus) # zone urbaine sensible 
dr <- dr  %>% mutate_at(vars(salmee, sexe, ag, nbenfa18, dip5, cser, chpub, ancentr, immi, desc,zus), funs(as.numeric))

#write_dta(d, "/Users/hugomarty/Documents/GitHub/Project-of-Econometrics", version = 14)
# education, employment, household charecteristics, gender, occupation, industry, age)
# temps complets

```


## 3) First Table: Provide a table with brief summary statistics.

```{r}

# Sample size
nrow(d) #nombre d'observations
#length(dr) nombre de variables

# Average age in the population

d$ag <- as.numeric(d$ag)
mean(d$ag)

# Distribution of education

d$dip5 <- as.numeric(d$dip5)

#tab_ed <- table(d$dip5)
#view(tab_ed)
#sort(tab_ed)
#barplot(sort(tab_ed), col = "skyblue", main = "Répartition de la population selon le niveau de diplôme atteint")

freq_ed <- freq(d$dip5) 
view(freq_ed)

# Occupation

d$cser <- as.numeric(d$cser)
#hist(d$cser, main = "Répartition de la population selon la profession occupée")

freq_occupation <- freq(d$cser) 
view(freq_occupation)

#Table with all the summary statistics

# A FAIRE

```


## 4) Second Table: 
Perform a regression of log wages on a gender dummy variable without other controls (unconditional wage gap). Perform similar regressions but include progressively additional sets of control variables. Report regression results in a single table across different columns as in an academic paper. Comment the results

```{r}
d$salmee <- as.numeric(d$salmee)
d$logsal <- log(d$salmee)
dr$logsal <- log(dr$salmee)
reg1 <- lm(d$logsal ~ d$sexe)
stargazer(reg1)

rega <- lm(logsal ~ sexe + dip5, data = dr) # salaires, sexe, éducation

library(naniar)
dr$sector <- as.factor(dr$nafg004n) %>% replace_with_na_if(.predicate = is.factor, condition = ~00)

regb <-lm(logsal ~ sexe + dip5 + ancentr + sector, data = dr) # salaires, sexe, éducation, ancienneté, 

regc <- lm(logsal ~ sexe + dip5 + ancentr + nafantg004n + chpub, data = dr) # salaires, sexe, éducation, ancienneté, secteur, public vs privé
regd <- lm(logsal ~ sexe + dip5 + ancentr + nafantg004n + nbenfa18, data = dr) # salaires, sexe, éducation, ancienneté, secteur, nombre d'enfants de moins 18

stargazer(reg1, rega, regb, regc, regd)


```


## 5) Third Table: 
Perform the same exercise but separately for those with more and less than high-school education

```{r}

reg2_hs <- lm(d$logsal ~ d$sexe)
reg2_abovehs <- lm(d$logsal ~ d$sexe)

d$highschool <- ifelse(d$dip5<3,1,0) # égal à 1 quand l'individ a  fait  d'études supérieurs


reg2_onlyhs <- lm(formula = logsal[highschool=='0'] ~ sexe[highschool=='0'], data = d)
reg2_abovehs <- lm(formula = logsal[highschool=='1'] ~ sexe[highschool=='1'], data = d)


stargazer(reg2_onlyhs)
stargazer(reg2_abovehs)

```


## 6) Fourth Table (not compulsory): 
Perform further analysis that you might find interesting 7) Comment

```{r}

```

